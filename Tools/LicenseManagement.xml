<!--Title: Skuid License Management - Where are all my Skuid licenses on Salesforce? -->
<!-- Instructions:  Create a new page in your Salesforce org.  Copy the XML below into it. 
 You will be able to see all users that have been granted Skuid Licenses, 
 Even Guest Site Users,  Chatter Free users and others that don't normally show in standard User lists-->
<!-- Related Links:  
Docs: https://docs.skuid.com/latest/en/skuid/deploy/salesforce/user-access/#skuid-sample-page-license-management
Community Post: https://community.skuid.com/skuid/topics/the-users-show-2-users-and-4-licenses-but-none-available
-->
<!-- DataSource: Salesforce  (no new datasource needed)-->
<!-- Design System: None -->
<!-- Origin: SFDC Demo Org -->

<skuidpage unsavedchangeswarning="yes" personalizationmode="server" showsidebar="false" showheader="false" tabtooverride="User">
    <models>
        <model id="User" limit="100" query="true" createrowifnonefound="false" sobject="User" orderby="LastLoginDate ASC" datasource="salesforce">
            <fields>
                <field id="FirstName"/>
                <field id="LastName"/>
                <field id="CreatedDate"/>
                <field id="LastLoginDate"/>
                <field id="IsActive"/>
                <field id="Username"/>
                <field id="ProfileId"/>
                <field id="Profile.Name"/>
            </fields>
            <conditions>
                <condition type="join" value="" field="Id" operator="in" enclosevalueinquotes="true" joinobject="UserPackageLicense" joinfield="UserId">
                    <conditions>
                        <condition type="fieldvalue" value="skuid" enclosevalueinquotes="true" field="PackageLicense.NamespacePrefix"/>
                    </conditions>
                </condition>
            </conditions>
            <actions/>
        </model>
        <model id="SelectedUserPackageLicense" limit="1" query="false" createrowifnonefound="false" sobject="UserPackageLicense" datasource="salesforce">
            <fields>
                <field id="Id"/>
            </fields>
            <conditions>
                <condition type="fieldvalue" value="" enclosevalueinquotes="true" field="UserId" state="filterableoff" inactive="true" name="UserId"/>
                <condition type="fieldvalue" value="skuid" enclosevalueinquotes="true" field="PackageLicense.NamespacePrefix"/>
            </conditions>
            <actions/>
        </model>
        <model id="SkuidLicenses" limit="1" query="true" createrowifnonefound="false" sobject="PackageLicense" datasource="salesforce">
            <fields>
                <field id="ExpirationDate"/>
                <field id="UsedLicenses"/>
                <field id="Status"/>
                <field id="AllowedLicenses"/>
            </fields>
            <conditions>
                <condition type="fieldvalue" value="skuid" enclosevalueinquotes="true" field="NamespacePrefix"/>
            </conditions>
            <actions/>
        </model>
    </models>
    <components>
        <grid uniqueid="sk-xuyaW-380">
            <divisions>
                <division behavior="flex" minwidth="100px" ratio="4" verticalalign="top">
                    <components>
                        <pagetitle model="User" uniqueid="sk-xt7jv-81">
                            <maintitle>Users with a Skuid package License</maintitle>
                            <subtitle>                            </subtitle>
                            <actions/>
                        </pagetitle>
                    </components>
                </division>
                <division behavior="flex" verticalalign="top" minwidth="100px" ratio="6">
                    <components>
                        <basicfieldeditor showheader="true" showsavecancel="false" showerrorsinline="true" model="SkuidLicenses" uniqueid="sk-xv0df-389" mode="readonly" layout="">
                            <columns>
                                <column width="100%">
                                    <sections>
                                        <section title="Section A" collapsible="no" showheader="false">
                                            <fields>
                                                <field type="COMBO" editmodebehavior="autopopup" uniqueid="sk-296JVz-309">
                                                    <label>License Usage</label>
                                                    <template>{{UsedLicenses}} Deployed / {{AllowedLicenses}} Allowed
Contract Expiration: {{ExpirationDate}}
Status: {{Status}}</template>
                                                </field>
                                            </fields>
                                        </section>
                                    </sections>
                                </column>
                            </columns>
                        </basicfieldeditor>
                    </components>
                </division>
            </divisions>
            <styles>
                <styleitem type="background" bgtype="none"/>
            </styles>
        </grid>
        <skootable showconditions="true" showsavecancel="false" searchmethod="server" searchbox="true" showexportbuttons="false" pagesize="10" createrecords="false" model="User" mode="readonly" uniqueid="sk-xt7jv-82">
            <fields>
                <field id="FirstName" allowordering="true" uniqueid="sk-296JWJ-312"/>
                <field id="LastName" allowordering="true" uniqueid="sk-296JWO-314"/>
                <field id="Username" valuehalign="" type="" uniqueid="sk-296JWT-316"/>
                <field id="IsActive" type="" valuehalign="" uniqueid="sk-296JWU-318"/>
<field id="ProfileId" hideable="true" uniqueid="fi-2sE4-372"/>
                <field id="LastLoginDate" valuehalign="" type="" allowordering="true" uniqueid="sk-296JWW-320"/>
            </fields>
            <rowactions>
                <action type="multi" label="Revoke License" icon="sk-icon-remove-reference">
                    <actions>
                        <action type="custom" snippet="Confirm">
                            <onerroractions/>
                        </action>
                        <action type="blockUI" message="Revoking License for User..."/>
                        <action type="setCondition" model="SelectedUserPackageLicense" condition="UserId" value="}"/>
                        <action type="requeryModel" model="SelectedUserPackageLicense" behavior="standard"/>
                        <action type="markRowsForDeletion" model="SelectedUserPackageLicense"/>
                        <action type="save">
                            <models>
                                <model>SelectedUserPackageLicense</model>
                            </models>
                        </action>
                        <action type="requeryModel" model="User" behavior="standard"/>
                        <action type="blockUI" message="License revoked." timeout="1000"/>
                    </actions>
                </action>
            </rowactions>
            <massactions usefirstitemasdefault="true"/>
            <views>
                <view type="standard"/>
            </views>
        </skootable>
    </components>
    <resources>
        <labels/>
        <css/>
        <javascript/>
    <actionsequences uniqueid="sk-2sD_-347"/>
</resources>
    <styles>
        <styleitem type="background" bgtype="none"/>
    </styles>
</skuidpage>
